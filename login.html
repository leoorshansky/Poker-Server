<!DOCTYPE html>
<html>
    <head>
        <title>Poker Online V0.1.0</title>
        <link rel = "stylesheet" href = "/poker/login.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    </head>
    <body>
        <div class="log-form">
                <h2 id = "formtitle">Login to Poker</h2>
                <div>
                  <input type="text" id="username" placeholder="username" />
                  <input type="password" id="password" placeholder="password" />
                  <button type = "submit" class="btn" id = "submit">Login</button>
                  <p id = "create" class="forgot">Create Account</a>
                  </div>
              </div>
        <script>
            $(document).ready(() => {
                $("#submit").click(() => {
                    username = $("#username").val();
                    password = $("#password").val();
                    data = "username=" + username + "&password=" + password;
                    if (username != "" && password != "") {
                        $.post("/poker/login", data).done(data => {
                            status = data["status"];
                            if (status == "in") {
                                location.reload(true);
                            }
                            else if (status == "notfound") {
                                alert("Username not found.")
                            }
                            else if (status == "denied") {
                                alert("Password Incorrect.")
                            }
                        });
                    }
                });
                $("#create").click(() => {
                    $("#formtitle").text("Create an Account");
                    $("#password").after('<input type="password" id="confirmpassword" placeholder="confirm password" />');
                    $("#submit, #create").detach();
                    $("#confirmpassword").after('<button type = "submit" class="btn" id = "submitcreate">Create Account</button>');
                    $("#submitcreate").click(() => {
                        username = $("#username").val();
                        password = $("#password").val();
                        confirmpassword = $("#confirmpassword").val()
                        if (username != "" && password != "") {
                            if (confirmpassword == password) {
                                data = "username=" + username + "&password=" + password;
                                $.post("/poker/create", data).done(data => {
                                    if (data == "") {
                                        location.reload(true);
                                    }
                                    else {
                                        alert(data);
                                    }
                                });
                            }
                            else {
                                alert("Passwords do not match");
                            }
                        }
                        else {
                            alert("Please enter both a username and password.")
                        }
                    });
                });
            });
        </script>
    </body>
</html>